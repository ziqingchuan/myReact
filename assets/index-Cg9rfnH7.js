const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ArticleFormModal-Br8yYhKJ.js","assets/markdown-vendor-C07DKSYQ.js","assets/react-vendor-D-XgqoRR.js","assets/CustomSelect-CQ-O1Xz1.js","assets/icons-vendor-JV6Z2VAj.js","assets/supabase-vendor-BaswEe3z.js","assets/DirectoryFormModal-BnIx5Cd7.js"])))=>i.map(i=>d[i]);
import{j as e,M as t,r,a}from"./markdown-vendor-C07DKSYQ.js";import{a as n,r as i,R as s}from"./react-vendor-D-XgqoRR.js";import{c as o}from"./supabase-vendor-BaswEe3z.js";import{A as l,X as c,P as d,F as m,a as u,C as g,b as x,c as h,d as p,e as y,f,T as b,g as j,M as v,S as w,h as k,i as N,j as S,k as D,l as C,B as _,E as A,m as I,n as F}from"./icons-vendor-JV6Z2VAj.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var E={},T=n;E.createRoot=T.createRoot,E.hydrateRoot=T.hydrateRoot;const L={},O=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/myReact/"+e}(e))in L)return;L[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,r&&n.setAttribute("nonce",r),document.head.appendChild(n),t?new Promise((t,r)=>{n.addEventListener("load",t),n.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};let z=[{id:"1",name:"React åŸºç¡€",parent_id:null,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",articles:[{id:"1",title:"React ç®€ä»‹",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},{id:"2",title:"åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶",created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z"}]},{id:"2",name:"React Hooks",parent_id:null,created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z",articles:[{id:"3",title:"useState Hook",created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z"}]},{id:"3",name:"é«˜çº§æ¦‚å¿µ",parent_id:null,created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z",articles:[]}],R=[...[{id:"1",title:"React ç®€ä»‹",content:"# React ç®€ä»‹\n\nReact æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œç”± Facebook å¼€å‘å¹¶ç»´æŠ¤ã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–çš„å¼€å‘æ–¹å¼ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ„å»ºå¯å¤ç”¨çš„ UI ç»„ä»¶ã€‚\n\n## ä¸ºä»€ä¹ˆé€‰æ‹© Reactï¼Ÿ\n\n### 1. ç»„ä»¶åŒ–å¼€å‘\nReact å°† UI æ‹†åˆ†æˆç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€å’Œé€»è¾‘ã€‚\n\n```jsx\nfunction Welcome(props) {\n  return <h1>Hello, {props.name}!</h1>;\n}\n```\n\n### 2. è™šæ‹Ÿ DOM\nReact ä½¿ç”¨è™šæ‹Ÿ DOM æ¥æé«˜æ€§èƒ½ï¼Œåªæ›´æ–°å®é™…å‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†ã€‚\n\n### 3. å•å‘æ•°æ®æµ\næ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼Œä½¿åº”ç”¨çš„æ•°æ®æµæ›´åŠ å¯é¢„æµ‹ã€‚\n\n### 4. ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ\nReact æ‹¥æœ‰åºå¤§çš„ç¤¾åŒºå’Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ã€‚\n\n## æ ¸å¿ƒæ¦‚å¿µ\n\n- **ç»„ä»¶ (Components)**: UI çš„åŸºæœ¬æ„å»ºå—\n- **JSX**: JavaScript çš„è¯­æ³•æ‰©å±•\n- **Props**: ç»„ä»¶çš„å±æ€§\n- **State**: ç»„ä»¶çš„çŠ¶æ€\n\n## å¼€å§‹å­¦ä¹ \n\nå‡†å¤‡å¥½å¼€å§‹ä½ çš„ React ä¹‹æ—…äº†å—ï¼Ÿè®©æˆ‘ä»¬ä»åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶å¼€å§‹ï¼",directory_id:"1",is_published:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",directories:{id:"1",name:"React åŸºç¡€"}},{id:"2",title:"åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶",content:'# åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶\n\nåœ¨ React ä¸­ï¼Œç»„ä»¶æ˜¯æ„å»ºç”¨æˆ·ç•Œé¢çš„åŸºæœ¬å•ä½ã€‚è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ç»„ä»¶ã€‚\n\n## å‡½æ•°ç»„ä»¶\n\næœ€ç®€å•çš„ç»„ä»¶æ˜¯å‡½æ•°ç»„ä»¶ï¼š\n\n```jsx\nfunction Greeting() {\n  return <h1>Hello, World!</h1>;\n}\n```\n\n## ä½¿ç”¨ç»„ä»¶\n\nåˆ›å»ºç»„ä»¶åï¼Œä½ å¯ä»¥åƒä½¿ç”¨ HTML æ ‡ç­¾ä¸€æ ·ä½¿ç”¨å®ƒï¼š\n\n```jsx\nfunction App() {\n  return (\n    <div>\n      <Greeting />\n      <Greeting />\n    </div>\n  );\n}\n```\n\n## å¸¦å‚æ•°çš„ç»„ä»¶\n\nç»„ä»¶å¯ä»¥æ¥æ”¶å‚æ•°ï¼ˆç§°ä¸º propsï¼‰ï¼š\n\n```jsx\nfunction Greeting(props) {\n  return <h1>Hello, {props.name}!</h1>;\n}\n\nfunction App() {\n  return (\n    <div>\n      <Greeting name="Alice" />\n      <Greeting name="Bob" />\n    </div>\n  );\n}\n```\n\n## JSX è§„åˆ™\n\n1. å¿…é¡»è¿”å›å•ä¸ªæ ¹å…ƒç´ \n2. ä½¿ç”¨ `className` è€Œä¸æ˜¯ `class`\n3. æ‰€æœ‰æ ‡ç­¾å¿…é¡»é—­åˆ\n4. ä½¿ç”¨é©¼å³°å‘½åæ³•\n\n```jsx\nfunction MyComponent() {\n  return (\n    <div className="container">\n      <img src="image.jpg" alt="Description" />\n      <input type="text" />\n    </div>\n  );\n}\n```',directory_id:"1",is_published:!0,created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z",directories:{id:"1",name:"React åŸºç¡€"}},{id:"3",title:"useState Hook",content:"# useState Hook\n\n`useState` æ˜¯ React ä¸­æœ€å¸¸ç”¨çš„ Hookï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ã€‚\n\n## åŸºæœ¬ç”¨æ³•\n\n```jsx\nimport { useState } from 'react';\n\nfunction Counter() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>\n        Click me\n      </button>\n    </div>\n  );\n}\n```\n\n## çŠ¶æ€æ›´æ–°\n\n### ç›´æ¥è®¾ç½®æ–°å€¼\n```jsx\nconst [name, setName] = useState('');\nsetName('Alice');\n```\n\n### åŸºäºå‰ä¸€ä¸ªçŠ¶æ€æ›´æ–°\n```jsx\nconst [count, setCount] = useState(0);\nsetCount(prevCount => prevCount + 1);\n```\n\n## æ³¨æ„äº‹é¡¹\n\n1. çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„\n2. ä¸è¦ç›´æ¥ä¿®æ”¹çŠ¶æ€å¯¹è±¡\n3. ä½¿ç”¨å‡½æ•°å¼æ›´æ–°é¿å…é—­åŒ…é—®é¢˜",directory_id:"2",is_published:!0,created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z",directories:{id:"2",name:"React Hooks"}}]];const M="https://vtslbeziohxlvmibthfp.supabase.co",Z=M.includes("your-project-id");let P=null;if(!Z)try{P=o(M,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ0c2xiZXppb2h4bHZtaWJ0aGZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4ODM4OTYsImV4cCI6MjA3OTQ1OTg5Nn0.S2NRwGzMNMC4e3JLdHTxkFYFHtyTq7Ja_vqptwJyGkM")}catch(oe){}function q(e,t){const r=e.map(e=>({...e,articles:t.filter(t=>t.directory_id===e.id)}));function a(e){const t=r.filter(t=>t.parent_id===e.id);return t.length>0&&(e.children=t.map(e=>a(e))),e}return r.filter(e=>!e.parent_id).map(e=>a(e))}const H={async getDirectoryTree(){if(Z||!P)return new Promise(e=>{setTimeout(()=>{const t=q(z,R);e(t)},100)});try{const{data:e,error:t}=await P.from("directories").select("*").order("created_at");if(t)throw t;const{data:r,error:a}=await P.from("articles").select("id, title, directory_id, created_at, updated_at").eq("is_published",!0).order("created_at");if(a)throw a;return q(e,r)}catch(oe){return q(z,R)}},async getArticle(e){if(Z||!P)return new Promise(t=>{setTimeout(()=>{const r=R.find(t=>t.id===e);t(r||null)},100)});try{const{data:t,error:r}=await P.from("articles").select("\n          *,\n          directories (\n            id,\n            name\n          )\n        ").eq("id",e).single();if(r)throw r;return t}catch(oe){return R.find(t=>t.id===e)||null}},async createDirectory(e){if(Z||!P)return new Promise((t,r)=>{setTimeout(()=>{try{const r={id:Date.now().toString(),...e,parent_id:e.parent_id||null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),articles:[]};z.push(r),t(r)}catch(oe){r(oe)}},100)});try{const{data:t,error:r}=await P.from("directories").insert(e).select().single();if(r)throw r;return t}catch(oe){const r={id:Date.now().toString(),...e,parent_id:e.parent_id||null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),articles:[]};return z.push(r),r}},async updateDirectory(e,t){if(Z||!P)return new Promise((r,a)=>{setTimeout(()=>{try{const n=z.findIndex(t=>t.id===e);if(n>-1){const a=z[n].parent_id,i=t.parent_id||null;if(z[n]={...z[n],...t,parent_id:i,updated_at:(new Date).toISOString()},a!==i){const t=e=>{R.forEach(t=>{t.directory_id===e&&(t.updated_at=(new Date).toISOString())});z.filter(t=>t.parent_id===e).forEach(e=>t(e.id))};t(e)}r(z[n])}else a(new Error("ç›®å½•ä¸å­˜åœ¨"))}catch(oe){a(oe)}},100)});try{const{data:r,error:a}=await P.from("directories").update(t).eq("id",e).select().single();if(a)throw a;return r}catch(oe){const a=z.findIndex(t=>t.id===e);if(a>-1){const r=z[a].parent_id,n=t.parent_id||null;if(z[a]={...z[a],...t,parent_id:n,updated_at:(new Date).toISOString()},r!==n){const t=e=>{R.forEach(t=>{t.directory_id===e&&(t.updated_at=(new Date).toISOString())});z.filter(t=>t.parent_id===e).forEach(e=>t(e.id))};t(e)}return z[a]}throw oe}},async deleteDirectory(e){if(Z||!P)return new Promise(t=>{setTimeout(()=>{const r=e=>{z.filter(t=>t.parent_id===e).forEach(e=>r(e.id));R.filter(t=>t.directory_id===e).forEach(e=>{const t=R.findIndex(t=>t.id===e.id);t>-1&&R.splice(t,1)});const t=z.findIndex(t=>t.id===e);t>-1&&z.splice(t,1)};r(e),t()},100)});try{const{error:t}=await P.from("directories").delete().eq("id",e);if(t)throw t}catch(oe){const r=e=>{z.filter(t=>t.parent_id===e).forEach(e=>r(e.id));R.filter(t=>t.directory_id===e).forEach(e=>{const t=R.findIndex(t=>t.id===e.id);t>-1&&R.splice(t,1)});const t=z.findIndex(t=>t.id===e);t>-1&&z.splice(t,1)};r(e)}},async createArticle(e){if(Z||!P)return new Promise(t=>{setTimeout(()=>{const r={id:Date.now().toString(),...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),directories:z.find(t=>t.id===e.directory_id)||null};R.push(r),t(r)},100)});try{const{data:t,error:r}=await P.from("articles").insert(e).select().single();if(r)throw r;return t}catch(oe){const r={id:Date.now().toString(),...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};return R.push(r),r}},async updateArticle(e,t){if(Z||!P)return new Promise(r=>{setTimeout(()=>{const a=R.findIndex(t=>t.id===e);a>-1&&(R[a]={...R[a],...t,updated_at:(new Date).toISOString()},r(R[a]))},100)});try{const{data:r,error:a}=await P.from("articles").update(t).eq("id",e).select().single();if(a)throw a;return r}catch(oe){const a=R.findIndex(t=>t.id===e);if(a>-1)return R[a]={...R[a],...t,updated_at:(new Date).toISOString()},R[a];throw oe}},async deleteArticle(e){if(Z||!P)return new Promise(t=>{setTimeout(()=>{const r=R.findIndex(t=>t.id===e);r>-1&&R.splice(r,1),t()},100)});try{const{error:t}=await P.from("articles").delete().eq("id",e);if(t)throw t}catch(oe){const r=R.findIndex(t=>t.id===e);r>-1&&R.splice(r,1)}},async searchArticles(e){if(Z||!P)return new Promise(t=>{setTimeout(()=>{let r=R.filter(e=>e.is_published);if(e&&e.trim()){const t=e.toLowerCase();r=r.filter(e=>e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t))}t(r.sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)))},100)});try{if(!e.trim()){const{data:e,error:t}=await P.from("articles").select("\n            *,\n            directories (\n              id,\n              name\n            )\n          ").eq("is_published",!0).order("created_at",{ascending:!1});if(t)throw t;return e}const{data:t,error:r}=await P.from("articles").select("\n          *,\n          directories (\n            id,\n            name\n          )\n        ").or(`title.ilike.%${e}%,content.ilike.%${e}%`).eq("is_published",!0).order("created_at",{ascending:!1});if(r)throw r;return t}catch(oe){return R.filter(e=>e.is_published)}}};function J({isOpen:t,onClose:r,onConfirm:a,title:n,message:i,confirmText:s="ç¡®è®¤",cancelText:o="å–æ¶ˆ",type:d="danger"}){if(!t)return null;const m={danger:{icon:"text-red-600",button:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},warning:{icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"},info:{icon:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}}[d];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full bg-gray-100 dark:bg-gray-700 ${m.icon}`,children:e.jsx(l,{size:20})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:n})]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(c,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:i}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 dark:focus:ring-blue-500 focus:border-transparent transition-colors",children:o}),e.jsx("button",{onClick:()=>{a(),r()},className:`px-4 py-2 text-white rounded-md focus:ring-2 focus:border-transparent ${m.button}`,children:s})]})]})]})})}function $({onItemClick:t,onArticleSelect:r,collapsed:a,onToggleCollapse:n,onEditArticle:s,onCreateArticle:o,onEditDirectory:l,onCreateDirectory:c,directories:v=[],directoriesLoading:w=!1,onLoadDirectories:k,selectedArticle:N=null}){const[S,D]=i.useState(new Set),[C,_]=i.useState(!1),[A,I]=i.useState({isOpen:!1,type:"danger",title:"",message:"",onConfirm:null});i.useEffect(()=>{if(v.length>0){const e=new Set,t=r=>{r.forEach(r=>{e.add(r.id),r.children&&r.children.length>0&&t(r.children)})};t(v),D(e)}},[v]);const F=(a,n=0)=>{const i=S.has(a.id),c=a.articles&&a.articles.length>0,d=a.children&&a.children.length>0,m=c||d;return e.jsxs("div",{className:"select-none",children:[e.jsxs("div",{className:"group flex items-center py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",style:{paddingLeft:12+16*n+"px"},children:[e.jsxs("div",{className:"flex items-center flex-1 cursor-pointer",onClick:()=>m&&(e=>{const t=new Set(S);t.has(e)?t.delete(e):t.add(e),D(t)})(a.id),children:[m?e.jsxs(e.Fragment,{children:[i?e.jsx(g,{size:16,className:"text-gray-400 mr-1"}):e.jsx(x,{size:16,className:"text-gray-400 mr-1"}),i?e.jsx(h,{size:16,className:"text-gray-600 mr-2"}):e.jsx(p,{size:16,className:"text-gray-600 mr-2"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 mr-1"}),e.jsx(p,{size:16,className:"text-gray-600 mr-2"})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate flex-1",title:a.name,children:a.name})]}),e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center space-x-1 ml-2",children:[e.jsx("button",{onClick:()=>l&&l(a),className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-gray-700",title:"ç¼–è¾‘ç›®å½•",children:e.jsx(y,{size:12})}),e.jsx("button",{onClick:()=>o&&o(a.id),className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-gray-700",title:"åœ¨æ­¤ç›®å½•ä¸‹æ–°å»ºæ–‡ç« ",children:e.jsx(f,{size:14})}),e.jsx("button",{onClick:()=>{var e;I({isOpen:!0,type:"danger",title:"åˆ é™¤ç›®å½•",message:`è¯¥æ“ä½œä¼šåˆ é™¤ç›®å½•"${(e=a).name}"åŠå…¶ä¸­å…¨éƒ¨æ–‡ç« ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`,onConfirm:async()=>{_(!0);try{await H.deleteDirectory(e.id),await k(!0),window.dispatchEvent(new CustomEvent("directoryDeleted",{detail:{directoryId:e.id}}))}catch(oe){alert("åˆ é™¤å¤±è´¥: "+oe.message)}finally{_(!1)}}})},className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-red-600",title:"åˆ é™¤ç›®å½•",children:e.jsx(b,{size:12})})]})]}),i&&e.jsxs("div",{children:[c&&a.articles.map(a=>{const i=N&&N.id===a.id;return e.jsxs("div",{className:"group flex items-center py-2 px-3 ml-2 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors "+(i?"bg-blue-50 dark:bg-blue-900/30 border-l-2 border-blue-600":""),style:{paddingLeft:28+16*n+"px"},children:[e.jsxs("button",{onClick:()=>{r&&r(a.id),t&&t()},className:"flex-1 flex items-center text-left min-w-0 "+(i?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),title:a.title,children:[e.jsx(j,{size:14,className:"mr-2 flex-shrink-0 "+(i?"text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500")}),e.jsx("span",{className:"text-sm truncate",children:a.title})]}),e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center space-x-1 ml-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>(async e=>{try{const t=await H.getArticle(e.id);s&&s(t)}catch(oe){alert("åŠ è½½æ–‡ç« å¤±è´¥: "+oe.message)}})(a),className:"p-1 hover:bg-gray-200 rounded text-gray-600 hover:text-gray-800",title:"ç¼–è¾‘æ–‡ç« ",children:e.jsx(y,{size:12})}),e.jsx("button",{onClick:()=>{return e=a.id,t=a.title,void I({isOpen:!0,type:"danger",title:"åˆ é™¤æ–‡ç« ",message:`æ˜¯å¦è¦åˆ é™¤æ–‡ç« "${t}"ï¼Ÿ`,onConfirm:async()=>{_(!0);try{await H.deleteArticle(e),await k(!0),window.dispatchEvent(new CustomEvent("articleDeleted",{detail:{articleId:e}}))}catch(oe){alert("åˆ é™¤å¤±è´¥: "+oe.message)}finally{_(!1)}}});var e,t},className:"p-1 hover:bg-gray-200 rounded text-gray-600 hover:text-red-600",title:"åˆ é™¤æ–‡ç« ",children:e.jsx(b,{size:12})})]})]},a.id)}),d&&a.children.map(e=>F(e,n+1))]})]},a.id)},E=()=>e.jsx("div",{className:"animate-pulse space-y-2",children:[...Array(5)].map((t,r)=>e.jsx("div",{className:"h-8 bg-gray-200 rounded"},r))});return a?e.jsx("nav",{className:"border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 fixed left-0 top-16 z-20 w-12 transition-colors",style:{height:"calc(100vh - 4rem)"},children:e.jsx("div",{className:"p-2",children:e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center text-gray-900 dark:text-gray-100 justify-center hover:bg-gray-100 rounded",title:"å±•å¼€ç›®å½•",children:e.jsx(d,{size:16})})})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 fixed left-0 top-16 z-20 w-80 flex flex-col transition-colors",style:{height:"calc(100vh - 4rem)"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 truncate",children:"æ–‡ç« ç›®å½•"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>c&&c(),className:"p-1 hover:bg-gray-100 rounded text-gray-900 dark:text-gray-100 hover:text-gray-800",title:"æ–°å»ºç›®å½•",children:e.jsx(m,{size:16})}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded text-gray-900 dark:text-gray-100",title:"æ”¶èµ·ç›®å½•",children:e.jsx(u,{size:16})})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:e.jsx("div",{className:"space-y-1",children:w?e.jsx(E,{}):0===v.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"æš‚æ— ç›®å½•"}),e.jsx("button",{onClick:()=>c&&c(),className:"mt-2 text-blue-600 hover:text-blue-700 text-sm",children:"åˆ›å»ºç¬¬ä¸€ä¸ªç›®å½•"})]}):v.map(e=>F(e))})})]}),e.jsx(J,{isOpen:A.isOpen,onClose:()=>I({...A,isOpen:!1}),onConfirm:A.onConfirm,title:A.title,message:A.message,type:A.type}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-xl",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"å¤„ç†ä¸­..."})]})})})]})}function B({isMobile:t,onMenuClick:r,isDark:a,onToggleDarkMode:n}){return e.jsx("header",{className:"bg-[#001529] dark:bg-gray-900 border-b border-gray-700 dark:border-gray-800 sticky top-0 z-30 transition-colors",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t&&e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",children:e.jsx(v,{size:20})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("img",{src:"/myReact/assets/react-CC1bUvkJ.svg",alt:"logo",className:"mx-auto"})}),e.jsx("span",{className:"text-xl font-bold text-white",children:"React æ—¥è®°"})]})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",title:a?"åˆ‡æ¢åˆ°æ˜äº®æ¨¡å¼":"åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼",children:a?e.jsx(w,{size:20}):e.jsx(k,{size:20})})]})})})}function G({content:n}){const[s,o]=i.useState(null),l=e=>"string"==typeof e?e:Array.isArray(e)?e.map(l).join(""):e&&"object"==typeof e&&e.props&&e.props.children?l(e.props.children):"",c=e=>l(e).toLowerCase().replace(/[^\w\u4e00-\u9fff]+/g,"-").replace(/^-+|-+$/g,"")||"heading",d=e=>{if("string"==typeof e)return e;if(Array.isArray(e))return e.map(d).join("");if(e&&"object"==typeof e){if(e.props&&e.props.children)return d(e.props.children);if(e.children)return d(e.children)}return""},m={pre({children:t}){const r=null==t?void 0:t.props,a=(null==r?void 0:r.className)||"",n=/language-(\w+)/.exec(a);if(n){const a=d(null==r?void 0:r.children),i=(e=>{let t=0;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return Math.abs(t).toString(36).substring(0,10)})(a.substring(0,100));return e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 dark:bg-gray-950 text-gray-200 dark:text-gray-300 px-4 py-2 text-sm rounded-t-lg border-b border-gray-700 dark:border-gray-800",children:[e.jsx("span",{className:"font-mono",children:n[1]}),e.jsx("button",{onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),o(t),setTimeout(()=>o(null),2e3)}catch(r){}})(a,i),className:"flex items-center space-x-1 hover:bg-gray-700 dark:hover:bg-gray-800 px-2 py-1 rounded transition-colors",children:s===i?e.jsxs(e.Fragment,{children:[e.jsx(N,{size:14}),e.jsx("span",{children:"å·²å¤åˆ¶"})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{size:14}),e.jsx("span",{children:"å¤åˆ¶"})]})})]}),e.jsx("pre",{className:"!mt-0 !rounded-t-none overflow-x-auto",children:t})]})}return e.jsx("pre",{children:t})},code:({node:t,inline:r,className:a,children:n,...i})=>r?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800/50 text-pink-600 dark:text-emerald-400 px-1.5 py-0.5 rounded text-sm font-mono border border-transparent dark:border-gray-700/50",...i,children:n}):e.jsx("code",{className:a,...i,children:n}),h1({children:t}){const r=c(t);return e.jsx("h1",{id:r,className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 mt-8 border-b border-gray-200 dark:border-gray-700 pb-2 scroll-mt-20",children:t})},h2({children:t}){const r=c(t);return e.jsx("h2",{id:r,className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4 mt-6 scroll-mt-20",children:t})},h3({children:t}){const r=c(t);return e.jsx("h3",{id:r,className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-3 mt-5 scroll-mt-20",children:t})},p:({children:t})=>e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-7 mb-4",children:t}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300",children:t}),blockquote:({children:t})=>e.jsx("blockquote",{className:"border-l-4 border-primary-500 pl-4 italic text-gray-600 dark:text-gray-400 mb-4 bg-gray-50 dark:bg-gray-800 py-2",children:t}),table:({children:t})=>e.jsx("div",{className:"overflow-x-auto mb-4",children:e.jsx("table",{className:"w-full border-collapse border border-gray-300",children:t})}),th:({children:t})=>e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left bg-gray-50 dark:bg-gray-800 dark:text-gray-200 font-semibold",children:t}),td:({children:t})=>e.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 dark:text-gray-300",children:t}),a:({href:t,children:r})=>e.jsx("a",{href:t,className:"text-primary-600 hover:text-primary-700 underline",target:(null==t?void 0:t.startsWith("http"))?"_blank":void 0,rel:(null==t?void 0:t.startsWith("http"))?"noopener noreferrer":void 0,children:r})};return e.jsx("div",{className:"prose max-w-none",children:e.jsx(t,{remarkPlugins:[a],rehypePlugins:[r],components:m,children:n})})}function U({article:t}){return t?e.jsxs("div",{className:"max-w-4xl mx-auto min-h-full",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:t.title}),t.description&&e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-6",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{size:16,className:"mr-1"}),e.jsxs("span",{children:["å‘å¸ƒäº ",(r=t.created_at,new Date(r).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}))]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{size:16,className:"mr-1"}),e.jsxs("span",{children:["é˜…è¯»æ—¶é—´ ",(e=>{const t=e.split(/\s+/).length;return Math.ceil(t/200)})(t.content)," åˆ†é’Ÿ"]})]})]})]}),e.jsx("article",{className:"prose max-w-none pb-8",children:e.jsx(G,{content:t.content})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"æ–‡ç« ä¸å­˜åœ¨"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"è¯·é€‰æ‹©å…¶ä»–æ–‡ç« "})]});var r}function W({onReturnHome:t}){return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/myReact/assets/notfound-BvOBckcb.svg",alt:"æ–‡ç« æœªæ‰¾åˆ°",className:"w-64 h-64 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"ç³Ÿç³•ï¼Œè¯¥æ–‡ç« ä¸è§äº†"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"æ‚¨æ­£åœ¨æŸ¥çœ‹çš„æ–‡ç« å·²è¢«åˆ é™¤æˆ–ç§»åŠ¨"}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800",children:"è¿”å›é¦–é¡µ"})]})}function X(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"max-w-4xl w-full",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl mb-6 shadow-lg",children:e.jsx(_,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-3 dark: text-gray-100",children:"React æ—¥è®°"}),e.jsx("p",{className:"text-lg text-gray-600",children:"ä»å·¦ä¾§ç›®å½•é€‰æ‹©æ–‡ç« å¼€å§‹å­¦ä¹ "})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4 text-center",children:"å‹æƒ…é“¾æ¥"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{name:"QCloud æ–‡ä»¶äº‘ç›˜",url:"https://try-catch.life/QCloud",description:"ä¸ªäººæ–‡ä»¶äº‘å­˜å‚¨æœåŠ¡",color:"from-blue-500 to-blue-600"},{name:"ä¸ªäººåšå®¢",url:"https://try-catch.life",description:"æŠ€æœ¯åˆ†äº«ä¸ç”Ÿæ´»è®°å½•",color:"from-purple-500 to-purple-600"},{name:"DailyUp æ—¥æŠ¥ç³»ç»Ÿ",url:"https://try-catch.life/DailyUp",description:"æ¯æ—¥å·¥ä½œè®°å½•ä¸æ€»ç»“",color:"from-green-500 to-green-600"},{name:"ç´ ç¬” Markdown",url:"https://marklite.cn",description:"ç®€æ´ä¼˜é›…çš„ Markdown ç¼–è¾‘å™¨",color:"from-orange-500 to-orange-600"}].map(t=>e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"group bg-white dark:bg-gray-800 rounded-lg p-5 shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600 transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full bg-gradient-to-r ${t.color} mr-2`}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:t.name})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.description})]}),e.jsx(A,{className:"w-4 h-4 text-gray-400 dark:text-gray-500 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors flex-shrink-0 ml-2"})]})},t.url))})]}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"ğŸ’¡ æç¤ºï¼šç‚¹å‡»å·¦ä¸Šè§’å›¾æ ‡å¯ä»¥å±•å¼€/æ”¶èµ·ä¾§è¾¹æ "})})]})})}function V({size:t="md",className:r=""}){return e.jsx("div",{className:`inline-flex items-center justify-center ${r}`,children:e.jsx("div",{className:`\n          ${{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"}[t]} \n          border-2 border-gray-200 border-t-gray-600 \n          rounded-full animate-spin\n        `})})}function Y({message:t="åŠ è½½ä¸­...",className:r=""}){return e.jsxs("div",{className:`flex flex-col items-center justify-center py-8 ${r}`,children:[e.jsx(V,{size:"lg",className:"mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm",children:t})]})}function Q({loading:t,articleLoading:r,articleNotFound:a,selectedArticle:n,onReturnHome:i}){return e.jsx("main",{className:"flex-1 min-w-0 overflow-auto h-screen bg-white dark:bg-gray-900 transition-colors",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8 pb-16",children:t?e.jsx(Y,{message:"æ­£åœ¨åŠ è½½..."}):r?e.jsx(Y,{message:"æ­£åœ¨åŠ è½½æ–‡ç« ..."}):a?e.jsx(W,{onReturnHome:i}):n?e.jsx(U,{article:n}):e.jsx(X,{})})})}function K({isOpen:t,onClose:r,onArticleSelect:a,directories:n,directoriesLoading:i,onLoadDirectories:s,selectedArticle:o}){return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r}),e.jsxs("div",{className:"fixed left-0 top-0 h-full w-80 bg-white shadow-lg z-50 transform transition-transform duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:bg-gray-900",children:[e.jsx("h2",{className:"text-lg font-semibold dark:text-gray-100",children:"ç›®å½•"}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded dark:text-gray-100",children:e.jsx(c,{size:20})})]}),e.jsx($,{onArticleSelect:a,onItemClick:r,directories:n,directoriesLoading:i,onLoadDirectories:s,selectedArticle:o})]})]}):null}function ee({content:t,collapsed:r,onToggleCollapse:a}){const[n,s]=i.useState([]),[o,l]=i.useState(""),c=i.useRef(null),d=i.useRef(!1),m=i.useRef(null),u=i.useRef(null),g=e=>e.toLowerCase().replace(/[^\w\u4e00-\u9fff]+/g,"-").replace(/^-+|-+$/g,"")||"heading";i.useEffect(()=>{if(!t)return void s([]);const e=/^(#{1,3})\s+(.+)$/gm,r=[];let a;for(;null!==(a=e.exec(t));){const e=a[1].length,t=a[2].trim(),n=g(t);r.push({id:n,text:t,level:e})}s(r)},[t]),i.useEffect(()=>{if(0===n.length||r)return;const e=setTimeout(()=>{const e=document.querySelector("main");if(!e)return;(()=>{if(!document.querySelector("main"))return;const e=n.map(e=>document.getElementById(e.id)).filter(Boolean);if(0===e.length)return;let t=e[0];for(const r of e){if(!(r.getBoundingClientRect().top<=100))break;t=r}l(t.id)})();const t=new IntersectionObserver(e=>{if(d.current)return;const t=e.filter(e=>e.isIntersecting).sort((e,t)=>e.boundingClientRect.top-t.boundingClientRect.top);if(t.length>0){const e=t[0];l(e.target.id)}},{root:e,rootMargin:"-10% 0% -80% 0%",threshold:[0,.25,.5,.75,1]});c.current=t,n.forEach(e=>{const r=document.getElementById(e.id);r&&t.observe(r)})},50);return()=>{clearTimeout(e),c.current&&c.current.disconnect()}},[n,r]),i.useEffect(()=>{o&&!r&&m.current&&u.current&&requestAnimationFrame(()=>{if(!u.current||!m.current)return;const e=m.current,t=u.current,r=e.getBoundingClientRect(),a=t.getBoundingClientRect(),n=a.top-r.top+e.scrollTop,i=n+a.height,s=e.scrollTop,o=e.clientHeight;n<s?e.scrollTo({top:n-20,behavior:"smooth"}):i>s+o&&e.scrollTo({top:i-o+20,behavior:"smooth"})})},[o,r]);return r?e.jsx("div",{className:"fixed right-0 top-16 z-20 w-12 border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-colors",style:{height:"calc(100vh - 4rem)"},children:e.jsx("div",{className:"p-2",children:e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center text-gray-900 dark:text-gray-100 justify-center hover:bg-gray-100 rounded",title:"å±•å¼€ç›®å½•",children:e.jsx(I,{size:16})})})}):e.jsxs("div",{className:"fixed right-0 top-16 z-20 w-64 border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-colors flex flex-col",style:{height:"calc(100vh - 4rem)"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"æ ‡é¢˜ç›®å½•"}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-gray-100 rounded text-gray-600 dark:text-gray-100",title:"æ”¶èµ·ç›®å½•",children:e.jsx(F,{size:16})})]})}),e.jsx("div",{ref:m,className:"flex-1 overflow-y-auto px-4 pb-4",children:0===n.length?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400 text-sm",children:e.jsx("p",{children:"å½“å‰æ–‡ç« æ— æ ‡é¢˜"})}):e.jsx("div",{className:"space-y-1",children:n.map(t=>{const r=o===t.id,a=16*(t.level-1)+12;return e.jsx("button",{ref:r?u:null,onClick:()=>(e=>{const t=document.getElementById(e);if(t){l(e),d.current=!0;const r=document.querySelector("main");if(r){const e=t.offsetTop,a=80;r.scrollTo({top:e-a,behavior:"smooth"}),setTimeout(()=>{d.current=!1},1e3)}else t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{d.current=!1},1e3)}})(t.id),className:`\n          w-full text-left py-2 px-3 text-sm transition-colors duration-200\n          hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100\n          ${r?"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 border-r-2 border-blue-600":"text-gray-600 dark:text-gray-400"}\n        `,style:{paddingLeft:`${a}px`},title:t.text,children:e.jsx("span",{className:"truncate block",children:t.text})},t.id)})})})]})}const te="directories_cache",re="directories_cache_time";function ae(){const[e,t]=i.useState(!1),[r,a]=i.useState(!1),[n,s]=i.useState(!1),[o,l]=i.useState(!1),[c,d]=i.useState(!0),[m,u]=i.useState(!1),[g,x]=i.useState(!1),[h,p]=i.useState(!1),[y,f]=i.useState(!0),[b,j]=i.useState(null),[v,w]=i.useState([]),[k,N]=i.useState(null),[S,D]=i.useState(!1),[C,_]=i.useState(!1),[A,I]=i.useState(null),[F,E]=i.useState({title:"",content:"",directory_id:"",is_published:!0}),[T,L]=i.useState({name:"",parent_id:""}),O=i.useRef(!1);i.useEffect(()=>{const e=()=>{a(window.innerWidth<768),window.innerWidth>=768&&t(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),i.useEffect(()=>{(async()=>{R(!0);const e=localStorage.getItem("lastArticleId");if(e){u(!0),x(!1);try{const t=await H.getArticle(e);j(t)}catch(oe){localStorage.removeItem("lastArticleId")}finally{u(!1),d(!1)}}else d(!1)})()},[]),i.useEffect(()=>{const e=e=>{const{articleId:t}=e.detail;j(e=>e&&e.id===t?(x(!0),localStorage.removeItem("lastArticleId"),null):e),z()},t=e=>{const{directoryId:t}=e.detail;j(e=>e&&e.directory_id===t?(x(!0),localStorage.removeItem("lastArticleId"),null):e),z()};return window.addEventListener("articleDeleted",e),window.addEventListener("directoryDeleted",t),()=>{window.removeEventListener("articleDeleted",e),window.removeEventListener("directoryDeleted",t)}},[]);const z=i.useCallback(()=>{try{localStorage.removeItem(te),localStorage.removeItem(re)}catch(oe){}},[]),R=i.useCallback(async(e=!1,t=!1)=>{if(t||!O.current){if(!t){const e=(()=>{try{const e=localStorage.getItem(te),t=localStorage.getItem(re);if(e&&t){if(Date.now()-parseInt(t,10)<3e4)return JSON.parse(e)}}catch(oe){}return null})();if(e)return w(e),void f(!1)}O.current=!0,e&&f(!0);try{const e=await H.getDirectoryTree();w(e),(e=>{try{localStorage.setItem(te,JSON.stringify(e)),localStorage.setItem(re,Date.now().toString())}catch(oe){}})(e)}catch(oe){}finally{f(!1),O.current=!1}}},[]),M=(e,t=0)=>{let r=[];return e.forEach(e=>{const a="ã€€".repeat(t);r.push({value:e.id,label:a+e.name}),e.children&&e.children.length>0&&(r=r.concat(M(e.children,t+1)))}),r};return{sidebarOpen:e,setSidebarOpen:t,isMobile:r,sidebarCollapsed:n,setSidebarCollapsed:s,tocCollapsed:o,setTocCollapsed:l,loading:c,articleLoading:m,articleNotFound:g,setArticleNotFound:x,formLoading:h,setFormLoading:p,directoriesLoading:y,selectedArticle:b,directories:v,editingArticle:k,setEditingArticle:N,showCreateForm:S,setShowCreateForm:D,showCreateDirForm:C,setShowCreateDirForm:_,editingDirectory:A,setEditingDirectory:I,formData:F,setFormData:E,dirFormData:T,setDirFormData:L,loadDirectories:R,loadFirstArticle:async()=>{u(!0);try{const e=await H.searchArticles("");e&&e.length>0&&j(e[0])}catch(oe){}finally{d(!1),u(!1)}},handleArticleSelect:async e=>{u(!0),x(!1);try{const a=await H.getArticle(e);j(a),localStorage.setItem("lastArticleId",e),r&&t(!1)}catch(oe){x(!0),localStorage.removeItem("lastArticleId")}finally{u(!1),d(!1)}},getDirectoryOptions:M,invalidateCache:z}}const ne=i.lazy(()=>O(()=>import("./ArticleFormModal-Br8yYhKJ.js"),__vite__mapDeps([0,1,2,3,4,5]))),ie=i.lazy(()=>O(()=>import("./DirectoryFormModal-BnIx5Cd7.js"),__vite__mapDeps([6,1,2,3,4,5])));function se(){const t=ae(),{isDark:r,toggleDarkMode:a}=function(){const[e,t]=i.useState(()=>{const e=localStorage.getItem("darkMode");return null!==e?"true"===e:window.matchMedia("(prefers-color-scheme: dark)").matches});return i.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",e)},[e]),{isDark:e,toggleDarkMode:()=>{t(e=>!e)}}}(),n=function({setFormLoading:e,loadFirstArticle:t,loadDirectories:r,setFormData:a,setEditingArticle:n,setShowCreateForm:i,invalidateCache:s}){const o=()=>{a({title:"",content:"",directory_id:"",is_published:!0}),n(null),i(!1)};return{handleEditArticle:e=>{n(e),a({title:e.title,content:e.content,directory_id:e.directory_id||"",is_published:e.is_published}),i(!0)},handleSubmitArticle:async(a,n,i)=>{a.preventDefault(),e(!0);try{i?await H.updateArticle(i.id,n):await H.createArticle(n),o(),s(),await r(!0,!0),await t()}catch(oe){alert("ä¿å­˜å¤±è´¥: "+oe.message)}finally{e(!1)}},resetForm:o}}({setFormLoading:t.setFormLoading,loadFirstArticle:t.loadFirstArticle,loadDirectories:t.loadDirectories,setFormData:t.setFormData,setEditingArticle:t.setEditingArticle,setShowCreateForm:t.setShowCreateForm,invalidateCache:t.invalidateCache}),s=function({setFormLoading:e,loadDirectories:t,setDirFormData:r,setEditingDirectory:a,setShowCreateDirForm:n,invalidateCache:i}){const s=()=>{r({name:"",parent_id:""}),a(null),n(!1)};return{handleCreateDirectory:()=>{a(null),r({name:"",parent_id:""}),n(!0)},handleEditDirectory:e=>{a(e),r({name:e.name,parent_id:e.parent_id||""}),n(!0)},handleSubmitDirectory:async(r,a,n)=>{if(r.preventDefault(),a.name.trim()){e(!0);try{const e={name:a.name.trim(),parent_id:a.parent_id||null};n?await H.updateDirectory(n.id,e):await H.createDirectory(e),s(),i(),await t(!0,!0)}catch(oe){alert("ä¿å­˜ç›®å½•å¤±è´¥: "+oe.message)}finally{e(!1)}}else alert("è¯·è¾“å…¥ç›®å½•åç§°")},resetDirForm:s}}({setFormLoading:t.setFormLoading,loadDirectories:t.loadDirectories,setDirFormData:t.setDirFormData,setEditingDirectory:t.setEditingDirectory,setShowCreateDirForm:t.setShowCreateDirForm,invalidateCache:t.invalidateCache});return e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors",children:[e.jsx(B,{isMobile:t.isMobile,onMenuClick:()=>t.setSidebarOpen(!0),isDark:r,onToggleDarkMode:a}),e.jsxs("div",{className:"flex relative",children:[!t.isMobile&&e.jsx("div",{className:(t.sidebarCollapsed?"w-12":"w-80")+" flex-shrink-0",children:e.jsx($,{onArticleSelect:t.handleArticleSelect,collapsed:t.sidebarCollapsed,onToggleCollapse:()=>t.setSidebarCollapsed(!t.sidebarCollapsed),onEditArticle:n.handleEditArticle,onCreateArticle:e=>{t.setFormData({...t.formData,directory_id:e}),t.setShowCreateForm(!0)},onEditDirectory:s.handleEditDirectory,onCreateDirectory:s.handleCreateDirectory,directories:t.directories,directoriesLoading:t.directoriesLoading,onLoadDirectories:t.loadDirectories,selectedArticle:t.selectedArticle})}),e.jsx(K,{isOpen:t.sidebarOpen,onClose:()=>t.setSidebarOpen(!1),onArticleSelect:t.handleArticleSelect,directories:t.directories,directoriesLoading:t.directoriesLoading,onLoadDirectories:t.loadDirectories,selectedArticle:t.selectedArticle}),e.jsx(Q,{loading:t.loading,articleLoading:t.articleLoading,articleNotFound:t.articleNotFound,selectedArticle:t.selectedArticle,onReturnHome:()=>{t.setArticleNotFound(!1),t.loadFirstArticle()}}),!t.isMobile&&t.selectedArticle&&!t.articleNotFound&&e.jsx("div",{className:(t.tocCollapsed?"w-12":"w-64")+" flex-shrink-0",children:e.jsx(ee,{content:t.selectedArticle.content,collapsed:t.tocCollapsed,onToggleCollapse:()=>t.setTocCollapsed(!t.tocCollapsed)})}),e.jsx(i.Suspense,{fallback:null,children:e.jsx(ne,{isOpen:t.showCreateForm,editingArticle:t.editingArticle,formData:t.formData,directories:t.directories,formLoading:t.formLoading,onClose:n.resetForm,onSubmit:e=>n.handleSubmitArticle(e,t.formData,t.editingArticle),onFormDataChange:t.setFormData,getDirectoryOptions:t.getDirectoryOptions})}),e.jsx(i.Suspense,{fallback:null,children:e.jsx(ie,{isOpen:t.showCreateDirForm,editingDirectory:t.editingDirectory,dirFormData:t.dirFormData,directories:t.directories,formLoading:t.formLoading,onClose:s.resetDirForm,onSubmit:e=>s.handleSubmitDirectory(e,t.dirFormData,t.editingDirectory),onFormDataChange:t.setDirFormData,getDirectoryOptions:t.getDirectoryOptions})})]})]})}E.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(se,{})}));export{V as L};
