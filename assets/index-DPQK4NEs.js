const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ArticleFormModal--zRUZxOP.js","assets/markdown-vendor-C07DKSYQ.js","assets/react-vendor-D-XgqoRR.js","assets/LoadingSpinner-Cn40j3bh.js","assets/icons-vendor-BjRWV-8O.js","assets/DirectoryFormModal-D5OjMQFi.js","assets/AuthModal-BUmN6D8w.js"])))=>i.map(i=>d[i]);
import{j as e,M as t,r,a}from"./markdown-vendor-C07DKSYQ.js";import{a as s,r as n,R as i}from"./react-vendor-D-XgqoRR.js";import{c as o}from"./supabase-vendor-BaswEe3z.js";import{A as d,X as l,P as c,F as g,a as m,C as x,b as u,c as h,d as y,e as p,f as b,T as f,g as j,M as v,G as k,L as N,K as w,S,h as D,i as C,j as _,k as A,l as I,U as E,E as F,m as T,n as L}from"./icons-vendor-BjRWV-8O.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var O={},z=s;O.createRoot=z.createRoot,O.hydrateRoot=z.hydrateRoot;const R={},M=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/myReact/"+e}(e))in R)return;R[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),t?new Promise((t,r)=>{s.addEventListener("load",t),s.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})};let Z=[{id:"1",name:"React åŸºç¡€",parent_id:null,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",articles:[{id:"1",title:"React ç®€ä»‹",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},{id:"2",title:"åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶",created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z"}]},{id:"2",name:"React Hooks",parent_id:null,created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z",articles:[{id:"3",title:"useState Hook",created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z"}]},{id:"3",name:"é«˜çº§æ¦‚å¿µ",parent_id:null,created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z",articles:[]}],P=[...[{id:"1",title:"React ç®€ä»‹",content:"# React ç®€ä»‹\n\nReact æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œç”± Facebook å¼€å‘å¹¶ç»´æŠ¤ã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–çš„å¼€å‘æ–¹å¼ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ„å»ºå¯å¤ç”¨çš„ UI ç»„ä»¶ã€‚\n\n## ä¸ºä»€ä¹ˆé€‰æ‹© Reactï¼Ÿ\n\n### 1. ç»„ä»¶åŒ–å¼€å‘\nReact å°† UI æ‹†åˆ†æˆç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€å’Œé€»è¾‘ã€‚\n\n```jsx\nfunction Welcome(props) {\n  return <h1>Hello, {props.name}!</h1>;\n}\n```\n\n### 2. è™šæ‹Ÿ DOM\nReact ä½¿ç”¨è™šæ‹Ÿ DOM æ¥æé«˜æ€§èƒ½ï¼Œåªæ›´æ–°å®é™…å‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†ã€‚\n\n### 3. å•å‘æ•°æ®æµ\næ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼Œä½¿åº”ç”¨çš„æ•°æ®æµæ›´åŠ å¯é¢„æµ‹ã€‚\n\n### 4. ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ\nReact æ‹¥æœ‰åºå¤§çš„ç¤¾åŒºå’Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ã€‚\n\n## æ ¸å¿ƒæ¦‚å¿µ\n\n- **ç»„ä»¶ (Components)**: UI çš„åŸºæœ¬æ„å»ºå—\n- **JSX**: JavaScript çš„è¯­æ³•æ‰©å±•\n- **Props**: ç»„ä»¶çš„å±æ€§\n- **State**: ç»„ä»¶çš„çŠ¶æ€\n\n## å¼€å§‹å­¦ä¹ \n\nå‡†å¤‡å¥½å¼€å§‹ä½ çš„ React ä¹‹æ—…äº†å—ï¼Ÿè®©æˆ‘ä»¬ä»åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶å¼€å§‹ï¼",directory_id:"1",is_published:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",directories:{id:"1",name:"React åŸºç¡€"}},{id:"2",title:"åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶",content:'# åˆ›å»ºç¬¬ä¸€ä¸ªç»„ä»¶\n\nåœ¨ React ä¸­ï¼Œç»„ä»¶æ˜¯æ„å»ºç”¨æˆ·ç•Œé¢çš„åŸºæœ¬å•ä½ã€‚è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ç»„ä»¶ã€‚\n\n## å‡½æ•°ç»„ä»¶\n\næœ€ç®€å•çš„ç»„ä»¶æ˜¯å‡½æ•°ç»„ä»¶ï¼š\n\n```jsx\nfunction Greeting() {\n  return <h1>Hello, World!</h1>;\n}\n```\n\n## ä½¿ç”¨ç»„ä»¶\n\nåˆ›å»ºç»„ä»¶åï¼Œä½ å¯ä»¥åƒä½¿ç”¨ HTML æ ‡ç­¾ä¸€æ ·ä½¿ç”¨å®ƒï¼š\n\n```jsx\nfunction App() {\n  return (\n    <div>\n      <Greeting />\n      <Greeting />\n    </div>\n  );\n}\n```\n\n## å¸¦å‚æ•°çš„ç»„ä»¶\n\nç»„ä»¶å¯ä»¥æ¥æ”¶å‚æ•°ï¼ˆç§°ä¸º propsï¼‰ï¼š\n\n```jsx\nfunction Greeting(props) {\n  return <h1>Hello, {props.name}!</h1>;\n}\n\nfunction App() {\n  return (\n    <div>\n      <Greeting name="Alice" />\n      <Greeting name="Bob" />\n    </div>\n  );\n}\n```\n\n## JSX è§„åˆ™\n\n1. å¿…é¡»è¿”å›å•ä¸ªæ ¹å…ƒç´ \n2. ä½¿ç”¨ `className` è€Œä¸æ˜¯ `class`\n3. æ‰€æœ‰æ ‡ç­¾å¿…é¡»é—­åˆ\n4. ä½¿ç”¨é©¼å³°å‘½åæ³•\n\n```jsx\nfunction MyComponent() {\n  return (\n    <div className="container">\n      <img src="image.jpg" alt="Description" />\n      <input type="text" />\n    </div>\n  );\n}\n```',directory_id:"1",is_published:!0,created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z",directories:{id:"1",name:"React åŸºç¡€"}},{id:"3",title:"useState Hook",content:"# useState Hook\n\n`useState` æ˜¯ React ä¸­æœ€å¸¸ç”¨çš„ Hookï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ã€‚\n\n## åŸºæœ¬ç”¨æ³•\n\n```jsx\nimport { useState } from 'react';\n\nfunction Counter() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>\n        Click me\n      </button>\n    </div>\n  );\n}\n```\n\n## çŠ¶æ€æ›´æ–°\n\n### ç›´æ¥è®¾ç½®æ–°å€¼\n```jsx\nconst [name, setName] = useState('');\nsetName('Alice');\n```\n\n### åŸºäºå‰ä¸€ä¸ªçŠ¶æ€æ›´æ–°\n```jsx\nconst [count, setCount] = useState(0);\nsetCount(prevCount => prevCount + 1);\n```\n\n## æ³¨æ„äº‹é¡¹\n\n1. çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„\n2. ä¸è¦ç›´æ¥ä¿®æ”¹çŠ¶æ€å¯¹è±¡\n3. ä½¿ç”¨å‡½æ•°å¼æ›´æ–°é¿å…é—­åŒ…é—®é¢˜",directory_id:"2",is_published:!0,created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z",directories:{id:"2",name:"React Hooks"}}]];const q="https://vtslbeziohxlvmibthfp.supabase.co",H=q.includes("your-project-id");let J=null;if(!H)try{J=o(q,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ0c2xiZXppb2h4bHZtaWJ0aGZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4ODM4OTYsImV4cCI6MjA3OTQ1OTg5Nn0.S2NRwGzMNMC4e3JLdHTxkFYFHtyTq7Ja_vqptwJyGkM")}catch(xe){}function $(e,t){const r=e.map(e=>({...e,articles:t.filter(t=>t.directory_id===e.id)}));function a(e){const t=r.filter(t=>t.parent_id===e.id);return t.length>0&&(e.children=t.map(e=>a(e))),e}return r.filter(e=>!e.parent_id).map(e=>a(e))}const B={async getDirectoryTree(){if(H||!J)return new Promise(e=>{setTimeout(()=>{const t=$(Z,P);e(t)},100)});try{const{data:e,error:t}=await J.from("directories").select("*").order("created_at");if(t)throw t;const{data:r,error:a}=await J.from("articles").select("id, title, directory_id, created_at, updated_at").eq("is_published",!0).order("created_at");if(a)throw a;return $(e,r)}catch(xe){return $(Z,P)}},async getArticle(e){if(H||!J)return new Promise(t=>{setTimeout(()=>{const r=P.find(t=>t.id===e);t(r||null)},100)});try{const{data:t,error:r}=await J.from("articles").select("\n          *,\n          directories (\n            id,\n            name\n          )\n        ").eq("id",e).single();if(r)throw r;return t}catch(xe){return P.find(t=>t.id===e)||null}},async createDirectory(e){if(H||!J)return new Promise((t,r)=>{setTimeout(()=>{try{const r={id:Date.now().toString(),...e,parent_id:e.parent_id||null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),articles:[]};Z.push(r),t(r)}catch(xe){r(xe)}},100)});try{const{data:t,error:r}=await J.from("directories").insert(e).select().single();if(r)throw r;return t}catch(xe){const r={id:Date.now().toString(),...e,parent_id:e.parent_id||null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),articles:[]};return Z.push(r),r}},async updateDirectory(e,t){if(H||!J)return new Promise((r,a)=>{setTimeout(()=>{try{const s=Z.findIndex(t=>t.id===e);if(s>-1){const a=Z[s].parent_id,n=t.parent_id||null;if(Z[s]={...Z[s],...t,parent_id:n,updated_at:(new Date).toISOString()},a!==n){const t=e=>{P.forEach(t=>{t.directory_id===e&&(t.updated_at=(new Date).toISOString())});Z.filter(t=>t.parent_id===e).forEach(e=>t(e.id))};t(e)}r(Z[s])}else a(new Error("ç›®å½•ä¸å­˜åœ¨"))}catch(xe){a(xe)}},100)});try{const{data:r,error:a}=await J.from("directories").update(t).eq("id",e).select().single();if(a)throw a;return r}catch(xe){const a=Z.findIndex(t=>t.id===e);if(a>-1){const r=Z[a].parent_id,s=t.parent_id||null;if(Z[a]={...Z[a],...t,parent_id:s,updated_at:(new Date).toISOString()},r!==s){const t=e=>{P.forEach(t=>{t.directory_id===e&&(t.updated_at=(new Date).toISOString())});Z.filter(t=>t.parent_id===e).forEach(e=>t(e.id))};t(e)}return Z[a]}throw xe}},async deleteDirectory(e){if(H||!J)return new Promise(t=>{setTimeout(()=>{const r=e=>{Z.filter(t=>t.parent_id===e).forEach(e=>r(e.id));P.filter(t=>t.directory_id===e).forEach(e=>{const t=P.findIndex(t=>t.id===e.id);t>-1&&P.splice(t,1)});const t=Z.findIndex(t=>t.id===e);t>-1&&Z.splice(t,1)};r(e),t()},100)});try{const{error:t}=await J.from("directories").delete().eq("id",e);if(t)throw t}catch(xe){const r=e=>{Z.filter(t=>t.parent_id===e).forEach(e=>r(e.id));P.filter(t=>t.directory_id===e).forEach(e=>{const t=P.findIndex(t=>t.id===e.id);t>-1&&P.splice(t,1)});const t=Z.findIndex(t=>t.id===e);t>-1&&Z.splice(t,1)};r(e)}},async createArticle(e){if(H||!J)return new Promise(t=>{setTimeout(()=>{const r={id:Date.now().toString(),...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),directories:Z.find(t=>t.id===e.directory_id)||null};P.push(r),t(r)},100)});try{const{data:t,error:r}=await J.from("articles").insert(e).select().single();if(r)throw r;return t}catch(xe){const r={id:Date.now().toString(),...e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};return P.push(r),r}},async updateArticle(e,t){if(H||!J)return new Promise(r=>{setTimeout(()=>{const a=P.findIndex(t=>t.id===e);a>-1&&(P[a]={...P[a],...t,updated_at:(new Date).toISOString()},r(P[a]))},100)});try{const{data:r,error:a}=await J.from("articles").update(t).eq("id",e).select().single();if(a)throw a;return r}catch(xe){const a=P.findIndex(t=>t.id===e);if(a>-1)return P[a]={...P[a],...t,updated_at:(new Date).toISOString()},P[a];throw xe}},async deleteArticle(e){if(H||!J)return new Promise(t=>{setTimeout(()=>{const r=P.findIndex(t=>t.id===e);r>-1&&P.splice(r,1),t()},100)});try{const{error:t}=await J.from("articles").delete().eq("id",e);if(t)throw t}catch(xe){const r=P.findIndex(t=>t.id===e);r>-1&&P.splice(r,1)}},async searchArticles(e){if(H||!J)return new Promise(t=>{setTimeout(()=>{let r=P.filter(e=>e.is_published);if(e&&e.trim()){const t=e.toLowerCase();r=r.filter(e=>e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t))}t(r.sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)))},100)});try{if(!e.trim()){const{data:e,error:t}=await J.from("articles").select("\n            *,\n            directories (\n              id,\n              name\n            )\n          ").eq("is_published",!0).order("created_at",{ascending:!1});if(t)throw t;return e}const{data:t,error:r}=await J.from("articles").select("\n          *,\n          directories (\n            id,\n            name\n          )\n        ").or(`title.ilike.%${e}%,content.ilike.%${e}%`).eq("is_published",!0).order("created_at",{ascending:!1});if(r)throw r;return t}catch(xe){return P.filter(e=>e.is_published)}}};function G({isOpen:t,onClose:r,onConfirm:a,title:s,message:n,confirmText:i="ç¡®è®¤",cancelText:o="å–æ¶ˆ",type:c="danger"}){if(!t)return null;const g={danger:{icon:"text-red-600",button:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},warning:{icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"},info:{icon:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}}[c];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full bg-gray-100 dark:bg-gray-700 ${g.icon}`,children:e.jsx(d,{size:20})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s})]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(l,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:n}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 dark:focus:ring-blue-500 focus:border-transparent transition-colors",children:o}),e.jsx("button",{onClick:()=>{a(),r()},className:`px-4 py-2 text-white rounded-md focus:ring-2 focus:border-transparent ${g.button}`,children:i})]})]})]})})}function U(){return e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-32"})]}),e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-40"})]}),e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-36"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-28"})]}),e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-44"})]}),e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"})]}),e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-38"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-36"})]}),e.jsx("div",{className:"ml-6 space-y-2",children:e.jsxs("div",{className:"flex items-center space-x-2 py-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-40"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-30"})]})]})}function W({onItemClick:t,onArticleSelect:r,collapsed:a,onToggleCollapse:s,onEditArticle:i,onCreateArticle:o,onEditDirectory:d,onCreateDirectory:l,directories:v=[],directoriesLoading:k=!1,onLoadDirectories:N,selectedArticle:w=null,isAuthenticated:S=!1}){const[D,C]=n.useState(new Set),[_,A]=n.useState(!1),[I,E]=n.useState({isOpen:!1,type:"danger",title:"",message:"",onConfirm:null});n.useEffect(()=>{if(v.length>0){const e=new Set,t=r=>{r.forEach(r=>{e.add(r.id),r.children&&r.children.length>0&&t(r.children)})};t(v),C(e)}},[v]);const F=(a,s=0)=>{const n=D.has(a.id),l=a.articles&&a.articles.length>0,c=a.children&&a.children.length>0,g=l||c;return e.jsxs("div",{className:"select-none",children:[e.jsxs("div",{className:"group flex items-center py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",style:{paddingLeft:12+16*s+"px"},children:[e.jsxs("div",{className:"flex items-center flex-1 cursor-pointer",onClick:()=>g&&(e=>{const t=new Set(D);t.has(e)?t.delete(e):t.add(e),C(t)})(a.id),children:[g?e.jsxs(e.Fragment,{children:[n?e.jsx(x,{size:16,className:"text-gray-400 mr-1"}):e.jsx(u,{size:16,className:"text-gray-400 mr-1"}),n?e.jsx(h,{size:16,className:"text-gray-600 mr-2"}):e.jsx(y,{size:16,className:"text-gray-600 mr-2"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 mr-1"}),e.jsx(y,{size:16,className:"text-gray-600 mr-2"})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate flex-1",title:a.name,children:a.name})]}),S&&e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center space-x-1 ml-2",children:[e.jsx("button",{onClick:()=>d&&d(a),className:"p-1 hover:bg-gray-300 rounded text-gray-700 dark:text-gray-100 dark:hover:bg-gray-500",title:"ç¼–è¾‘ç›®å½•",children:e.jsx(p,{size:12})}),e.jsx("button",{onClick:()=>o&&o(a.id),className:"p-1 hover:bg-gray-300 rounded text-gray-700 dark:text-gray-100 dark:hover:bg-gray-500",title:"åœ¨æ­¤ç›®å½•ä¸‹æ–°å»ºæ–‡ç« ",children:e.jsx(b,{size:14})}),e.jsx("button",{onClick:()=>{var e;E({isOpen:!0,type:"danger",title:"åˆ é™¤ç›®å½•",message:`è¯¥æ“ä½œä¼šåˆ é™¤ç›®å½•"${(e=a).name}"åŠå…¶ä¸­å…¨éƒ¨æ–‡ç« ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`,onConfirm:async()=>{A(!0);try{await B.deleteDirectory(e.id),await N(!0),window.dispatchEvent(new CustomEvent("directoryDeleted",{detail:{directoryId:e.id}}))}catch(xe){alert("åˆ é™¤å¤±è´¥: "+xe.message)}finally{A(!1)}}})},className:"p-1 hover:bg-gray-300 hover:text-red-500 rounded text-gray-700 dark:text-gray-100 dark:hover:bg-gray-500 dark:hover:text-red-500",title:"åˆ é™¤ç›®å½•",children:e.jsx(f,{size:12})})]})]}),n&&e.jsxs("div",{children:[l&&a.articles.map(a=>{const n=w&&w.id===a.id;return e.jsxs("div",{className:"group flex items-center py-2 px-3 ml-2 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors "+(n?"bg-blue-50 dark:bg-blue-900/30 border-l-2 border-blue-600":""),style:{paddingLeft:28+16*s+"px"},children:[e.jsxs("button",{onClick:()=>{r&&r(a.id),t&&t()},className:"flex-1 flex items-center text-left min-w-0 "+(n?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),title:a.title,children:[e.jsx(j,{size:14,className:"mr-2 flex-shrink-0 "+(n?"text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500")}),e.jsx("span",{className:"text-sm truncate",children:a.title})]}),S&&e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex items-center space-x-1 ml-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>(async e=>{try{const t=await B.getArticle(e.id);i&&i(t)}catch(xe){alert("åŠ è½½æ–‡ç« å¤±è´¥: "+xe.message)}})(a),className:"p-1 hover:bg-gray-300 rounded text-gray-700 dark:text-gray-100 dark:hover:bg-gray-500",title:"ç¼–è¾‘æ–‡ç« ",children:e.jsx(p,{size:12})}),e.jsx("button",{onClick:()=>{return e=a.id,t=a.title,void E({isOpen:!0,type:"danger",title:"åˆ é™¤æ–‡ç« ",message:`æ˜¯å¦è¦åˆ é™¤æ–‡ç« "${t}"ï¼Ÿ`,onConfirm:async()=>{A(!0);try{await B.deleteArticle(e),await N(!0),window.dispatchEvent(new CustomEvent("articleDeleted",{detail:{articleId:e}}))}catch(xe){alert("åˆ é™¤å¤±è´¥: "+xe.message)}finally{A(!1)}}});var e,t},className:"p-1 hover:bg-gray-300 hover:text-red-500 rounded text-gray-700 dark:text-gray-100 dark:hover:bg-gray-500 dark:hover:text-red-500",title:"åˆ é™¤æ–‡ç« ",children:e.jsx(f,{size:12})})]})]},a.id)}),c&&a.children.map(e=>F(e,s+1))]})]},a.id)};return a?e.jsx("nav",{className:"border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 fixed left-0 top-16 z-20 w-12 transition-colors",style:{height:"calc(100vh - 4rem)"},children:e.jsx("div",{className:"p-2",children:e.jsx("button",{onClick:s,className:"w-8 h-8 flex items-center text-gray-900 dark:text-gray-100 justify-center hover:bg-gray-400 rounded",title:"å±•å¼€ç›®å½•",children:e.jsx(c,{size:16})})})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 fixed left-0 top-16 z-20 w-80 flex flex-col transition-colors",style:{height:"calc(100vh - 4rem)"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 truncate",children:"æ–‡ç« ç›®å½•"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[S&&e.jsx("button",{onClick:()=>l&&l(),className:"p-1 hover:bg-gray-400 rounded text-gray-900 dark:text-gray-100 hover:text-gray-800",title:"æ–°å»ºç›®å½•",children:e.jsx(g,{size:16})}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-400 rounded text-gray-900 dark:text-gray-100",title:"æ”¶èµ·ç›®å½•",children:e.jsx(m,{size:16})})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4 custom-scrollbar",children:e.jsx("div",{className:"space-y-1",children:k?e.jsx(U,{}):0===v.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"æš‚æ— ç›®å½•"}),e.jsx("button",{onClick:()=>l&&l(),className:"mt-2 text-blue-600 hover:text-blue-700 text-sm",children:"åˆ›å»ºç¬¬ä¸€ä¸ªç›®å½•"})]}):v.map(e=>F(e))})})]}),e.jsx(G,{isOpen:I.isOpen,onClose:()=>E({...I,isOpen:!1}),onConfirm:I.onConfirm,title:I.title,message:I.message,type:I.type}),_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-xl",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"å¤„ç†ä¸­..."})]})})})]})}const V="/myReact/assets/react-CC1bUvkJ.svg";function X({isMobile:t,onMenuClick:r,isDark:a,onToggleDarkMode:s,isAuthenticated:n,onAuthClick:i,onLogout:o}){return e.jsx("header",{className:"bg-[#001529] dark:bg-gray-900 border-b border-gray-700 dark:border-gray-800 sticky top-0 z-30 transition-colors",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t&&e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",children:e.jsx(v,{size:20})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("img",{src:V,alt:"logo",className:"mx-auto"})}),e.jsx("span",{className:"text-xl font-bold text-white",children:"React æ—¥è®°"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("a",{href:"https://github.com/ziqingchuan",target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",title:"è®¿é—® GitHub",children:e.jsx(k,{size:20})}),n?e.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-green-400 transition-colors",title:"é€€å‡ºç¼–è¾‘æ¨¡å¼",children:e.jsx(N,{size:20})}):e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",title:"å¼€å¯ç¼–è¾‘æƒé™",children:e.jsx(w,{size:20})}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md text-white transition-colors",title:a?"åˆ‡æ¢åˆ°æ˜äº®æ¨¡å¼":"åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼",children:a?e.jsx(S,{size:20}):e.jsx(D,{size:20})})]})]})})})}function Q({content:s}){const[i,o]=n.useState(null),d=e=>"string"==typeof e?e:Array.isArray(e)?e.map(d).join(""):e&&"object"==typeof e&&e.props&&e.props.children?d(e.props.children):"",l=e=>d(e).toLowerCase().replace(/[^\w\u4e00-\u9fff]+/g,"-").replace(/^-+|-+$/g,"")||"heading",c=e=>{if("string"==typeof e)return e;if(Array.isArray(e))return e.map(c).join("");if(e&&"object"==typeof e){if(e.props&&e.props.children)return c(e.props.children);if(e.children)return c(e.children)}return""},g={pre({children:t}){const r=null==t?void 0:t.props,a=(null==r?void 0:r.className)||"",s=/language-(\w+)/.exec(a);if(s){const a=c(null==r?void 0:r.children),n=(e=>{let t=0;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return Math.abs(t).toString(36).substring(0,10)})(a.substring(0,100));return e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-4 py-2 text-sm rounded-t-lg border-b border-gray-300 dark:border-gray-700",children:[e.jsx("span",{className:"font-mono",children:s[1]}),e.jsx("button",{onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),o(t),setTimeout(()=>o(null),2e3)}catch(r){}})(a,n),className:"flex items-center space-x-1 hover:bg-gray-200 dark:hover:bg-gray-700 px-2 py-1 rounded transition-colors",children:i===n?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:14}),e.jsx("span",{children:"å·²å¤åˆ¶"})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{size:14}),e.jsx("span",{children:"å¤åˆ¶"})]})})]}),e.jsx("pre",{className:"!mt-0 !rounded-t-none overflow-x-auto bg-gray-50 dark:bg-gray-900",children:t})]})}return e.jsx("pre",{children:t})},code:({node:t,inline:r,className:a,children:s,...n})=>r?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800/50 text-pink-600 dark:text-emerald-400 px-1.5 py-0.5 rounded text-sm font-mono border border-transparent dark:border-gray-700/50",...n,children:s}):e.jsx("code",{className:a,...n,children:s}),h1({children:t}){const r=l(t);return e.jsx("h1",{id:r,className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 mt-8 border-b border-gray-200 dark:border-gray-700 pb-2 scroll-mt-20",children:t})},h2({children:t}){const r=l(t);return e.jsx("h2",{id:r,className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4 mt-6 scroll-mt-20",children:t})},h3({children:t}){const r=l(t);return e.jsx("h3",{id:r,className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-3 mt-5 scroll-mt-20",children:t})},p:({children:t})=>e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-7 mb-4",children:t}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300",children:t}),blockquote:({children:t})=>e.jsx("blockquote",{className:"border-l-4 border-primary-500 pl-4 italic text-gray-600 dark:text-gray-400 mb-4 bg-gray-50 dark:bg-gray-800 py-2",children:t}),table:({children:t})=>e.jsx("div",{className:"overflow-x-auto mb-4",children:e.jsx("table",{className:"w-full border-collapse border border-gray-300 dark:border-gray-600",children:t})}),th:({children:t})=>e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left bg-gray-50 dark:bg-gray-800 dark:text-gray-200 font-semibold",children:t}),td:({children:t})=>e.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 dark:text-gray-300",children:t}),a:({href:t,children:r})=>e.jsx("a",{href:t,className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 underline",target:(null==t?void 0:t.startsWith("http"))?"_blank":void 0,rel:(null==t?void 0:t.startsWith("http"))?"noopener noreferrer":void 0,children:r})};return e.jsx("div",{className:"prose max-w-none",children:e.jsx(t,{remarkPlugins:[a],rehypePlugins:[r],components:g,children:s})})}function Y({article:t}){const r=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return t?e.jsxs("div",{className:"max-w-4xl mx-auto min-h-full",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:t.title}),t.description&&e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-6",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{size:16,className:"mr-1"}),e.jsxs("span",{children:["å‘å¸ƒäº ",r(t.created_at)]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{size:16,className:"mr-1"}),e.jsxs("span",{children:["é˜…è¯»æ—¶é—´ ",(e=>{const t=e.split(/\s+/).length;return Math.ceil(t/200)})(t.content)," åˆ†é’Ÿ"]})]})]})]}),e.jsx("article",{className:"prose max-w-none pb-8",children:e.jsx(Q,{content:t.content})}),e.jsxs("footer",{className:"mt-8 pt-8 pb-10 border-t border-gray-200 dark:border-gray-700 flex flex-col items-end gap-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(A,{size:14,className:"mr-2"}),e.jsxs("span",{children:["æœ€åæ›´æ–°äº: ",r(t.updated_at)]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(E,{size:14,className:"mr-2"}),e.jsx("span",{children:"ä½œè€…: Qingchuan Zi"})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"æ–‡ç« ä¸å­˜åœ¨"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"è¯·é€‰æ‹©å…¶ä»–æ–‡ç« "})]})}function K({onReturnHome:t}){return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/myReact/assets/notfound-BvOBckcb.svg",alt:"æ–‡ç« æœªæ‰¾åˆ°",className:"w-64 h-64 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"ç³Ÿç³•ï¼Œè¯¥æ–‡ç« ä¸è§äº†"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"æ‚¨æ­£åœ¨æŸ¥çœ‹çš„æ–‡ç« å·²è¢«åˆ é™¤æˆ–ç§»åŠ¨"}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800",children:"è¿”å›é¦–é¡µ"})]})}function ee(){return e.jsx("div",{className:"flex items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"max-w-4xl w-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl mb-6 shadow-lg",children:e.jsx("img",{src:V,alt:"logo",className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-6 dark:text-gray-100",children:"React æ—¥è®°"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-500",children:"ä»å·¦ä¾§ç›®å½•é€‰æ‹©æ–‡ç« å¼€å§‹å­¦ä¹ "})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4 text-center",children:"å‹æƒ…é“¾æ¥"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{name:"QCloud æ–‡ä»¶äº‘ç›˜",url:"https://try-catch.life/QCloud",description:"ä¸ªäººæ–‡ä»¶äº‘å­˜å‚¨æœåŠ¡",color:"from-blue-500 to-blue-600"},{name:"ä¸ªäººåšå®¢",url:"https://try-catch.life",description:"æŠ€æœ¯åˆ†äº«ä¸ç”Ÿæ´»è®°å½•",color:"from-purple-500 to-purple-600"},{name:"DailyUp æ—¥æŠ¥ç³»ç»Ÿ",url:"https://try-catch.life/DailyUp",description:"æ¯æ—¥å·¥ä½œè®°å½•ä¸æ€»ç»“",color:"from-green-500 to-green-600"},{name:"ç´ ç¬” Markdown",url:"https://marklite.cn",description:"ç®€æ´ä¼˜é›…çš„ Markdown ç¼–è¾‘å™¨",color:"from-orange-500 to-orange-600"}].map(t=>e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"group bg-white dark:bg-gray-800 rounded-lg p-5 shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600 transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full bg-gradient-to-r ${t.color} mr-2`}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:t.name})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.description})]}),e.jsx(F,{className:"w-4 h-4 text-gray-400 dark:text-gray-500 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors flex-shrink-0 ml-2"})]})},t.url))})]}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"ğŸ’¡ æç¤ºï¼šç‚¹å‡»å·¦ä¸Šè§’å›¾æ ‡å¯ä»¥å±•å¼€/æ”¶èµ·ä¾§è¾¹æ "})})]})})}function te(){return e.jsxs("div",{className:"max-w-4xl mx-auto animate-pulse",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-6"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"})]}),e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mt-8"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5"})]}),e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded mt-6"}),e.jsxs("div",{className:"space-y-2 mt-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})]}),e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mt-8"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"})]}),e.jsxs("div",{className:"space-y-2 mt-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-11/12"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-10/12"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-11/12"})]})]})]})}function re({loading:t,articleLoading:r,articleNotFound:a,selectedArticle:s,onReturnHome:n}){return e.jsx("main",{className:"flex-1 min-w-0 overflow-auto h-screen bg-white dark:bg-gray-900 transition-colors custom-scrollbar",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8 pb-16",children:t||r?e.jsx(te,{}):a?e.jsx(K,{onReturnHome:n}):s?e.jsx(Y,{article:s}):e.jsx(ee,{})})})}function ae({isOpen:t,onClose:r,onArticleSelect:a,directories:s,directoriesLoading:n,onLoadDirectories:i,selectedArticle:o}){return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r}),e.jsxs("div",{className:"fixed left-0 top-0 h-full w-80 bg-white shadow-lg z-50 transform transition-transform duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:bg-gray-900",children:[e.jsx("h2",{className:"text-lg font-semibold dark:text-gray-100",children:"ç›®å½•"}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded dark:text-gray-100",children:e.jsx(l,{size:20})})]}),e.jsx(W,{onArticleSelect:a,onItemClick:r,directories:s,directoriesLoading:n,onLoadDirectories:i,selectedArticle:o})]})]}):null}function se({content:t,collapsed:r,onToggleCollapse:a}){const[s,i]=n.useState([]),[o,d]=n.useState(""),l=n.useRef(null),c=n.useRef(!1),g=n.useRef(null),m=n.useRef(null),x=e=>e.toLowerCase().replace(/[^\w\u4e00-\u9fff]+/g,"-").replace(/^-+|-+$/g,"")||"heading";n.useEffect(()=>{if(!t)return void i([]);const e=/^(#{1,3})\s+(.+)$/gm,r=[];let a;for(;null!==(a=e.exec(t));){const e=a[1].length,t=a[2].trim(),s=x(t);r.push({id:s,text:t,level:e})}i(r)},[t]),n.useEffect(()=>{if(0===s.length||r)return;const e=setTimeout(()=>{const e=document.querySelector("main");if(!e)return;(()=>{if(!document.querySelector("main"))return;const e=s.map(e=>document.getElementById(e.id)).filter(Boolean);if(0===e.length)return;let t=e[0];for(const r of e){if(!(r.getBoundingClientRect().top<=100))break;t=r}d(t.id)})();const t=new IntersectionObserver(e=>{if(c.current)return;const t=e.filter(e=>e.isIntersecting).sort((e,t)=>e.boundingClientRect.top-t.boundingClientRect.top);if(t.length>0){const e=t[0];d(e.target.id)}},{root:e,rootMargin:"-10% 0% -80% 0%",threshold:[0,.25,.5,.75,1]});l.current=t,s.forEach(e=>{const r=document.getElementById(e.id);r&&t.observe(r)})},50);return()=>{clearTimeout(e),l.current&&l.current.disconnect()}},[s,r]),n.useEffect(()=>{o&&!r&&g.current&&m.current&&requestAnimationFrame(()=>{if(!m.current||!g.current)return;const e=g.current,t=m.current,r=e.getBoundingClientRect(),a=t.getBoundingClientRect(),s=a.top-r.top+e.scrollTop,n=s+a.height,i=e.scrollTop,o=e.clientHeight;s<i?e.scrollTo({top:s-20,behavior:"smooth"}):n>i+o&&e.scrollTo({top:n-o+20,behavior:"smooth"})})},[o,r]);return r?e.jsx("div",{className:"fixed right-0 top-16 z-20 w-12 border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-colors",style:{height:"calc(100vh - 4rem)"},children:e.jsx("div",{className:"p-2",children:e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center text-gray-900 dark:text-gray-100 justify-center hover:bg-gray-400 rounded",title:"å±•å¼€ç›®å½•",children:e.jsx(T,{size:16})})})}):e.jsxs("div",{className:"fixed right-0 top-16 z-20 w-80 border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-colors flex flex-col",style:{height:"calc(100vh - 4rem)"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"æ ‡é¢˜ç›®å½•"}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-gray-400 rounded text-gray-600 dark:text-gray-100",title:"æ”¶èµ·ç›®å½•",children:e.jsx(L,{size:16})})]})}),e.jsx("div",{ref:g,className:"flex-1 overflow-y-auto px-4 pb-4 custom-scrollbar",children:0===s.length?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400 text-sm",children:e.jsx("p",{children:"å½“å‰æ–‡ç« æ— æ ‡é¢˜"})}):e.jsx("div",{className:"space-y-1",children:s.map(t=>{const r=o===t.id,a=16*(t.level-1)+12;return e.jsx("button",{ref:r?m:null,onClick:()=>(e=>{const t=document.getElementById(e);if(t){d(e),c.current=!0;const r=document.querySelector("main");if(r){const e=t.offsetTop,a=80;r.scrollTo({top:e-a,behavior:"smooth"}),setTimeout(()=>{c.current=!1},1e3)}else t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{c.current=!1},1e3)}})(t.id),className:`\n          w-full text-left py-2 px-3 text-sm transition-colors duration-200\n          hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100\n          ${r?"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 border-r-2 border-blue-600":"text-gray-600 dark:text-gray-400"}\n        `,style:{paddingLeft:`${a}px`},title:t.text,children:e.jsx("span",{className:"truncate block",children:t.text})},t.id)})})})]})}const ne="directories_cache",ie="directories_cache_time";function oe(){const[e,t]=n.useState(!1),[r,a]=n.useState(!1),[s,i]=n.useState(!1),[o,d]=n.useState(!1),[l,c]=n.useState(!0),[g,m]=n.useState(!1),[x,u]=n.useState(!1),[h,y]=n.useState(!1),[p,b]=n.useState(!0),[f,j]=n.useState(null),[v,k]=n.useState([]),[N,w]=n.useState(null),[S,D]=n.useState(!1),[C,_]=n.useState(!1),[A,I]=n.useState(null),[E,F]=n.useState({title:"",content:"",directory_id:"",is_published:!0}),[T,L]=n.useState({name:"",parent_id:""}),O=n.useRef(!1);n.useEffect(()=>{const e=()=>{a(window.innerWidth<768),window.innerWidth>=768&&t(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),n.useEffect(()=>{(async()=>{R(!0);const e=localStorage.getItem("lastArticleId");if(e){m(!0),u(!1);try{const t=await B.getArticle(e);j(t)}catch(xe){localStorage.removeItem("lastArticleId")}finally{m(!1),c(!1)}}else c(!1)})()},[]),n.useEffect(()=>{const e=e=>{const{articleId:t}=e.detail;j(e=>e&&e.id===t?(u(!0),localStorage.removeItem("lastArticleId"),null):e),z()},t=e=>{const{directoryId:t}=e.detail;j(e=>e&&e.directory_id===t?(u(!0),localStorage.removeItem("lastArticleId"),null):e),z()};return window.addEventListener("articleDeleted",e),window.addEventListener("directoryDeleted",t),()=>{window.removeEventListener("articleDeleted",e),window.removeEventListener("directoryDeleted",t)}},[]);const z=n.useCallback(()=>{try{localStorage.removeItem(ne),localStorage.removeItem(ie)}catch(xe){}},[]),R=n.useCallback(async(e=!1,t=!1)=>{if(t||!O.current){if(!t){const e=(()=>{try{const e=localStorage.getItem(ne),t=localStorage.getItem(ie);if(e&&t){if(Date.now()-parseInt(t,10)<3e4)return JSON.parse(e)}}catch(xe){}return null})();if(e)return k(e),void b(!1)}O.current=!0,e&&b(!0);try{const e=await B.getDirectoryTree();k(e),(e=>{try{localStorage.setItem(ne,JSON.stringify(e)),localStorage.setItem(ie,Date.now().toString())}catch(xe){}})(e)}catch(xe){}finally{b(!1),O.current=!1}}},[]),M=(e,t=0)=>{let r=[];return e.forEach(e=>{const a="ã€€".repeat(t);r.push({value:e.id,label:a+e.name}),e.children&&e.children.length>0&&(r=r.concat(M(e.children,t+1)))}),r};return{sidebarOpen:e,setSidebarOpen:t,isMobile:r,sidebarCollapsed:s,setSidebarCollapsed:i,tocCollapsed:o,setTocCollapsed:d,loading:l,articleLoading:g,articleNotFound:x,setArticleNotFound:u,formLoading:h,setFormLoading:y,directoriesLoading:p,selectedArticle:f,directories:v,editingArticle:N,setEditingArticle:w,showCreateForm:S,setShowCreateForm:D,showCreateDirForm:C,setShowCreateDirForm:_,editingDirectory:A,setEditingDirectory:I,formData:E,setFormData:F,dirFormData:T,setDirFormData:L,loadDirectories:R,loadFirstArticle:async()=>{m(!0);try{const e=await B.searchArticles("");e&&e.length>0&&j(e[0])}catch(xe){}finally{c(!1),m(!1)}},handleArticleSelect:async e=>{m(!0),u(!1);try{const a=await B.getArticle(e);j(a),localStorage.setItem("lastArticleId",e),r&&t(!1)}catch(xe){u(!0),localStorage.removeItem("lastArticleId")}finally{m(!1),c(!1)}},getDirectoryOptions:M,invalidateCache:z}}const de="admin_authenticated";const le=n.lazy(()=>M(()=>import("./ArticleFormModal--zRUZxOP.js"),__vite__mapDeps([0,1,2,3,4]))),ce=n.lazy(()=>M(()=>import("./DirectoryFormModal-D5OjMQFi.js"),__vite__mapDeps([5,1,2,3,4]))),ge=n.lazy(()=>M(()=>import("./AuthModal-BUmN6D8w.js"),__vite__mapDeps([6,1,2,4])));function me(){const t=oe(),{isDark:r,toggleDarkMode:a}=function(){const[e,t]=n.useState(()=>{const e=localStorage.getItem("darkMode");return null!==e?"true"===e:window.matchMedia("(prefers-color-scheme: dark)").matches});return n.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",e)},[e]),{isDark:e,toggleDarkMode:()=>{t(e=>!e)}}}(),{isAuthenticated:s,login:i,logout:o}=function(){const[e,t]=n.useState(!1);return n.useEffect(()=>{const e=localStorage.getItem(de);t("true"===e)},[]),{isAuthenticated:e,login:e=>"zqc040521"===e&&(localStorage.setItem(de,"true"),t(!0),!0),logout:()=>{localStorage.removeItem(de),t(!1)}}}(),[d,l]=n.useState(!1),c=function({setFormLoading:e,loadDirectories:t,setFormData:r,setEditingArticle:a,setShowCreateForm:s,invalidateCache:n,handleArticleSelect:i}){const o=()=>{r({title:"",content:"",directory_id:"",is_published:!0}),a(null),s(!1)};return{handleEditArticle:e=>{a(e),r({title:e.title,content:e.content,directory_id:e.directory_id||"",is_published:e.is_published}),s(!0)},handleSubmitArticle:async(r,a,s)=>{r.preventDefault(),e(!0);try{let e;s?(await B.updateArticle(s.id,a),e=s.id):e=(await B.createArticle(a)).id,o(),n(),await t(!0,!0),e&&await i(e)}catch(xe){alert("ä¿å­˜å¤±è´¥: "+xe.message)}finally{e(!1)}},resetForm:o}}({setFormLoading:t.setFormLoading,loadDirectories:t.loadDirectories,setFormData:t.setFormData,setEditingArticle:t.setEditingArticle,setShowCreateForm:t.setShowCreateForm,invalidateCache:t.invalidateCache,handleArticleSelect:t.handleArticleSelect}),g=function({setFormLoading:e,loadDirectories:t,setDirFormData:r,setEditingDirectory:a,setShowCreateDirForm:s,invalidateCache:n}){const i=()=>{r({name:"",parent_id:""}),a(null),s(!1)};return{handleCreateDirectory:()=>{a(null),r({name:"",parent_id:""}),s(!0)},handleEditDirectory:e=>{a(e),r({name:e.name,parent_id:e.parent_id||""}),s(!0)},handleSubmitDirectory:async(r,a,s)=>{if(r.preventDefault(),a.name.trim()){e(!0);try{const e={name:a.name.trim(),parent_id:a.parent_id||null};s?await B.updateDirectory(s.id,e):await B.createDirectory(e),i(),n(),await t(!0,!0)}catch(xe){alert("ä¿å­˜ç›®å½•å¤±è´¥: "+xe.message)}finally{e(!1)}}else alert("è¯·è¾“å…¥ç›®å½•åç§°")},resetDirForm:i}}({setFormLoading:t.setFormLoading,loadDirectories:t.loadDirectories,setDirFormData:t.setDirFormData,setEditingDirectory:t.setEditingDirectory,setShowCreateDirForm:t.setShowCreateDirForm,invalidateCache:t.invalidateCache});return e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors",children:[e.jsx(X,{isMobile:t.isMobile,onMenuClick:()=>t.setSidebarOpen(!0),isDark:r,onToggleDarkMode:a,isAuthenticated:s,onAuthClick:()=>l(!0),onLogout:o}),e.jsxs("div",{className:"flex relative",children:[!t.isMobile&&e.jsx("div",{className:(t.sidebarCollapsed?"w-12":"w-80")+" flex-shrink-0",children:e.jsx(W,{onArticleSelect:t.handleArticleSelect,collapsed:t.sidebarCollapsed,onToggleCollapse:()=>t.setSidebarCollapsed(!t.sidebarCollapsed),onEditArticle:c.handleEditArticle,onCreateArticle:e=>{t.setFormData({...t.formData,directory_id:e}),t.setShowCreateForm(!0)},onEditDirectory:g.handleEditDirectory,onCreateDirectory:g.handleCreateDirectory,directories:t.directories,directoriesLoading:t.directoriesLoading,onLoadDirectories:t.loadDirectories,selectedArticle:t.selectedArticle,isAuthenticated:s})}),e.jsx(ae,{isOpen:t.sidebarOpen,onClose:()=>t.setSidebarOpen(!1),onArticleSelect:t.handleArticleSelect,directories:t.directories,directoriesLoading:t.directoriesLoading,onLoadDirectories:t.loadDirectories,selectedArticle:t.selectedArticle}),e.jsx(re,{loading:t.loading,articleLoading:t.articleLoading,articleNotFound:t.articleNotFound,selectedArticle:t.selectedArticle,onReturnHome:()=>{t.setArticleNotFound(!1),t.loadFirstArticle()}}),!t.isMobile&&t.selectedArticle&&!t.articleNotFound&&e.jsx("div",{className:(t.tocCollapsed?"w-12":"w-64")+" flex-shrink-0",children:e.jsx(se,{content:t.selectedArticle.content,collapsed:t.tocCollapsed,onToggleCollapse:()=>t.setTocCollapsed(!t.tocCollapsed)})}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(le,{isOpen:t.showCreateForm,editingArticle:t.editingArticle,formData:t.formData,directories:t.directories,formLoading:t.formLoading,onClose:c.resetForm,onSubmit:e=>c.handleSubmitArticle(e,t.formData,t.editingArticle),onFormDataChange:t.setFormData,getDirectoryOptions:t.getDirectoryOptions})}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(ce,{isOpen:t.showCreateDirForm,editingDirectory:t.editingDirectory,dirFormData:t.dirFormData,directories:t.directories,formLoading:t.formLoading,onClose:g.resetDirForm,onSubmit:e=>g.handleSubmitDirectory(e,t.dirFormData,t.editingDirectory),onFormDataChange:t.setDirFormData,getDirectoryOptions:t.getDirectoryOptions})}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(ge,{isOpen:d,onClose:()=>l(!1),onSubmit:i})})]})]})}O.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(me,{})}));
